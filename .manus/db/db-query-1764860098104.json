{
  "query": "-- Add isVerified field to suppliers table\nALTER TABLE suppliers ADD COLUMN IF NOT EXISTS isVerified INT UNSIGNED NOT NULL DEFAULT 0 AFTER verificationStatus;\n\n-- Create supplierCompanyProfile table\nCREATE TABLE IF NOT EXISTS supplierCompanyProfile (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL UNIQUE,\n  companyName VARCHAR(255) NOT NULL,\n  registrationNumber VARCHAR(100),\n  yearFounded INT,\n  headquarters TEXT,\n  regionalOffices JSON,\n  ownershipStructure ENUM('private', 'group', 'subsidiary') NOT NULL,\n  parentCompany VARCHAR(255),\n  missionStatement TEXT,\n  coreValues TEXT,\n  companyOverview TEXT,\n  numberOfEmployees INT,\n  annualRevenue INT,\n  websiteUrl VARCHAR(500),\n  linkedInUrl VARCHAR(500),\n  primaryContactName VARCHAR(255),\n  primaryContactTitle VARCHAR(255),\n  primaryContactEmail VARCHAR(320),\n  primaryContactPhone VARCHAR(50),\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  INDEX supplierCompanyProfile_supplierId_idx (supplierId)\n);\n\n-- Create verificationDocuments table\nCREATE TABLE IF NOT EXISTS verificationDocuments (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL,\n  documentType ENUM(\n    'insurance_liability',\n    'insurance_indemnity',\n    'insurance_workers_comp',\n    'dpa_signed',\n    'nda_signed',\n    'non_compete_signed',\n    'security_compliance',\n    'engineer_vetting_policy',\n    'other'\n  ) NOT NULL,\n  documentName VARCHAR(255) NOT NULL,\n  fileUrl VARCHAR(500) NOT NULL,\n  fileKey VARCHAR(500) NOT NULL,\n  fileSize INT NOT NULL,\n  mimeType VARCHAR(100) NOT NULL,\n  uploadedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  uploadedBy INT,\n  expiryDate TIMESTAMP NULL,\n  status ENUM('pending_review', 'approved', 'rejected', 'expired') NOT NULL DEFAULT 'pending_review',\n  reviewedBy INT,\n  reviewedAt TIMESTAMP NULL,\n  reviewNotes TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  FOREIGN KEY (uploadedBy) REFERENCES users(id),\n  FOREIGN KEY (reviewedBy) REFERENCES users(id),\n  INDEX verificationDocuments_supplierId_idx (supplierId),\n  INDEX verificationDocuments_documentType_idx (documentType),\n  INDEX verificationDocuments_status_idx (status)\n);\n\n-- Create supplierVerification table\nCREATE TABLE IF NOT EXISTS supplierVerification (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL UNIQUE,\n  status ENUM(\n    'not_started',\n    'in_progress',\n    'pending_review',\n    'under_review',\n    'approved',\n    'rejected',\n    'resubmission_required'\n  ) NOT NULL DEFAULT 'not_started',\n  submittedAt TIMESTAMP NULL,\n  reviewedBy INT,\n  reviewedAt TIMESTAMP NULL,\n  rejectionReason TEXT,\n  adminNotes TEXT,\n  approvedAt TIMESTAMP NULL,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  FOREIGN KEY (reviewedBy) REFERENCES users(id),\n  INDEX supplierVerification_supplierId_idx (supplierId),\n  INDEX supplierVerification_status_idx (status)\n);\n\n-- Create adminOrganization table\nCREATE TABLE IF NOT EXISTS adminOrganization (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255) NOT NULL,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Create adminUsers table\nCREATE TABLE IF NOT EXISTS adminUsers (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  userId INT NOT NULL,\n  organizationId INT NOT NULL,\n  role ENUM('owner', 'admin', 'viewer') NOT NULL DEFAULT 'viewer',\n  permissions JSON,\n  invitedBy INT,\n  invitedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  isActive INT UNSIGNED NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n  FOREIGN KEY (organizationId) REFERENCES adminOrganization(id) ON DELETE CASCADE,\n  FOREIGN KEY (invitedBy) REFERENCES users(id),\n  INDEX adminUsers_userId_idx (userId),\n  INDEX adminUsers_organizationId_idx (organizationId),\n  UNIQUE INDEX adminUsers_unique (userId, organizationId)\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 4PejtppQzUdF9US.e7bec8248b17 --database 2cukUCNz2S5THQpLSDbdYn --execute -- Add isVerified field to suppliers table\nALTER TABLE suppliers ADD COLUMN IF NOT EXISTS isVerified INT UNSIGNED NOT NULL DEFAULT 0 AFTER verificationStatus;\n\n-- Create supplierCompanyProfile table\nCREATE TABLE IF NOT EXISTS supplierCompanyProfile (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL UNIQUE,\n  companyName VARCHAR(255) NOT NULL,\n  registrationNumber VARCHAR(100),\n  yearFounded INT,\n  headquarters TEXT,\n  regionalOffices JSON,\n  ownershipStructure ENUM('private', 'group', 'subsidiary') NOT NULL,\n  parentCompany VARCHAR(255),\n  missionStatement TEXT,\n  coreValues TEXT,\n  companyOverview TEXT,\n  numberOfEmployees INT,\n  annualRevenue INT,\n  websiteUrl VARCHAR(500),\n  linkedInUrl VARCHAR(500),\n  primaryContactName VARCHAR(255),\n  primaryContactTitle VARCHAR(255),\n  primaryContactEmail VARCHAR(320),\n  primaryContactPhone VARCHAR(50),\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  INDEX supplierCompanyProfile_supplierId_idx (supplierId)\n);\n\n-- Create verificationDocuments table\nCREATE TABLE IF NOT EXISTS verificationDocuments (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL,\n  documentType ENUM(\n    'insurance_liability',\n    'insurance_indemnity',\n    'insurance_workers_comp',\n    'dpa_signed',\n    'nda_signed',\n    'non_compete_signed',\n    'security_compliance',\n    'engineer_vetting_policy',\n    'other'\n  ) NOT NULL,\n  documentName VARCHAR(255) NOT NULL,\n  fileUrl VARCHAR(500) NOT NULL,\n  fileKey VARCHAR(500) NOT NULL,\n  fileSize INT NOT NULL,\n  mimeType VARCHAR(100) NOT NULL,\n  uploadedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  uploadedBy INT,\n  expiryDate TIMESTAMP NULL,\n  status ENUM('pending_review', 'approved', 'rejected', 'expired') NOT NULL DEFAULT 'pending_review',\n  reviewedBy INT,\n  reviewedAt TIMESTAMP NULL,\n  reviewNotes TEXT,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  FOREIGN KEY (uploadedBy) REFERENCES users(id),\n  FOREIGN KEY (reviewedBy) REFERENCES users(id),\n  INDEX verificationDocuments_supplierId_idx (supplierId),\n  INDEX verificationDocuments_documentType_idx (documentType),\n  INDEX verificationDocuments_status_idx (status)\n);\n\n-- Create supplierVerification table\nCREATE TABLE IF NOT EXISTS supplierVerification (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  supplierId INT NOT NULL UNIQUE,\n  status ENUM(\n    'not_started',\n    'in_progress',\n    'pending_review',\n    'under_review',\n    'approved',\n    'rejected',\n    'resubmission_required'\n  ) NOT NULL DEFAULT 'not_started',\n  submittedAt TIMESTAMP NULL,\n  reviewedBy INT,\n  reviewedAt TIMESTAMP NULL,\n  rejectionReason TEXT,\n  adminNotes TEXT,\n  approvedAt TIMESTAMP NULL,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (supplierId) REFERENCES suppliers(id) ON DELETE CASCADE,\n  FOREIGN KEY (reviewedBy) REFERENCES users(id),\n  INDEX supplierVerification_supplierId_idx (supplierId),\n  INDEX supplierVerification_status_idx (status)\n);\n\n-- Create adminOrganization table\nCREATE TABLE IF NOT EXISTS adminOrganization (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255) NOT NULL,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Create adminUsers table\nCREATE TABLE IF NOT EXISTS adminUsers (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  userId INT NOT NULL,\n  organizationId INT NOT NULL,\n  role ENUM('owner', 'admin', 'viewer') NOT NULL DEFAULT 'viewer',\n  permissions JSON,\n  invitedBy INT,\n  invitedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  isActive INT UNSIGNED NOT NULL DEFAULT 1,\n  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n  FOREIGN KEY (organizationId) REFERENCES adminOrganization(id) ON DELETE CASCADE,\n  FOREIGN KEY (invitedBy) REFERENCES users(id),\n  INDEX adminUsers_userId_idx (userId),\n  INDEX adminUsers_organizationId_idx (organizationId),\n  UNIQUE INDEX adminUsers_unique (userId, organizationId)\n);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 1801
}